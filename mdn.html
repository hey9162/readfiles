<!doctype html>
<html>

<head>
    <meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />
    <title>图片上传</title>
    <script src="http://cdn.bootcss.com/jquery/3.1.0/jquery.min.js"></script>
    <style>
        input[disabled]{
            background-color: #cdcdcd;
        }
    </style>
    
</head>

<body>
    <form name="uploadForm">
        <table>
            <tbody>
                <tr>
                    <td><img class="showimg" style="width: 100px; height: 100px;" src="http://pic.rryao.com/onebuy/images/add.png"
                            alt="Image preview" /></td>
                    <td><input class="upinput" type="file" name="myPhoto" onchange="loadImageFile(this);" /></td>
                </tr>
                <tr>
                    <td><img class="showimg" style="width: 100px; height: 100px;" src="http://pic.rryao.com/onebuy/images/add.png"
                            alt="Image preview" /></td>
                    <td><input class="upinput" type="file" name="myPhoto" onchange="loadImageFile(this);" /></td>
                </tr>
            </tbody>
        </table>
    </form>
    <script type="text/javascript">
         oFReader = new FileReader(), rFilter = /^(?:image\/bmp|image\/cis\-cod|image\/gif|image\/ief|image\/jpeg|image\/jpeg|image\/jpeg|image\/pipeg|image\/png|image\/svg\+xml|image\/tiff|image\/x\-cmu\-raster|image\/x\-cmx|image\/x\-icon|image\/x\-portable\-anymap|image\/x\-portable\-bitmap|image\/x\-portable\-graymap|image\/x\-portable\-pixmap|image\/x\-rgb|image\/x\-xbitmap|image\/x\-xpixmap|image\/x\-xwindowdump)$/i;
        function loadImageFile(obj) {
            if (obj.files.length === 0) { return; }
            var oFile = obj.files[0];
            console.log(oFile)
            console.log(oFile.size);
            var size = (oFile.size) / 1024;
            console.log(size);
            if(size > 500){ 
                alert('您上传的图片过大！');
                 $(this).val(''); 
                 return;
            }
            if (!rFilter.test(oFile.type)) { 
                alert("请上传图片类型"); 
                return;
            }
            oFReader.readAsDataURL(oFile); //开始读取file对象的内容. 当读取操作完成时,readyState属性的值会成为DONE,
            //如果设置了onloadend事件处理程序,则调用之.同时,result属性中将包含一个data: URL格式的字符串以表示所读取文件的内容.；
            oFReader.onload = function (oFREvent) {
                var img = $(obj).parent().parent().find('.showimg').attr('src',oFREvent.target.result)
            };
        }
    </script>
</body>
</html>